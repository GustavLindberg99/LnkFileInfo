# Overview
The LnkFileInfo class is a class that parses LNK files and shows information about them, such as their target path, their icon, etc. Although LNK files are Windows-specific, this library is cross-platform, which means that it can also be used on non-Windows systems to parse LNK files that have been copied there from Windows.

# Setup
This class requires Qt 5 or later to work. You can download Qt [here](https://www.qt.io/download-qt-installer). You can then use this library by downloading [lnkfileinfo.hpp](https://raw.githubusercontent.com/GustavLindberg99/QtLnkFileInfo/main/lnkfileinfo.hpp) and putting it in the same folder as your source code. This library is header only, so to use it, you just have to do `#include "lnkfileinfo.hpp"`.

# Usage
## Constructors of the `LnkFileInfo` class
1. `LnkFileInfo()`

   Constructs an empty LnkFileInfo object. This object will be invalid until a new object is assigned to it.

2. `LnkFileInfo(const QString &file)`

   Constructs a new LnkFileInfo object that gives information about the given LNK file. `file` can be an absolute or a relative path.
   
3. `LnkFileInfo(const QFile &file)`

   Constructs a new LnkFileInfo object that gives information about the given LNK file. `file` can be an absolute or a relative path.
   
4. `LnkFileInfo(const QFileInfo &file): LnkFileInfo(QFileInfo(file))`

   Constructs a new LnkFileInfo object that gives information about the LNK file in `file`. `file` can be an absolute or a relative path.

5. The copy constructor are automatically generated by the compiler.

## Overloaded operators of the `LnkFileInfo` class

- `bool operator==(const LnkFileInfo &other) const`

  Returns `true` if this LnkFileInfo object refers to the same LNK file as `other`, and `false` otherwise. The behavior is undefined if both LnkFileInfo objects are either empty or refer to LNK files that do not exist.

- `bool operator!=(const LnkFileInfo &other) const`

  Returns `false` if this LnkFileInfo object refers to the same LNK file as `other`, and `true` otherwise. The behavior is undefined if both LnkFileInfo objects are either empty or refer to LNK files that do not exist.

- `operator QFile() const`

  Constructs a [`QFile`](https://doc.qt.io/qt-5/qfile.html) object referring to the LNK file.

- `operator QFileInfo() const`

  Constructs a [`QFileInfo`](https://doc.qt.io/qt-5/qfileinfo.html) object referring to the absolute path of the LNK file.

- The copy assignment operator is automatically generated by the compiler.

## Methods of the `LnkFileInfo` class
- `QString absolutePath() const`

  Returns the absolute path of the LNK file itself, including the file name.

- `QString absoluteTargetPath() const`

  Returns the absolute path of the target file. If the LNK file does not exist or is invalid, returns an empty string. If the LNK file exists and is valid but points to a nonexistent file, returns the absolute path of that nonexistent file.

- `QString commandLineArgs() const`

  Returns the command line arguments of the LNK file, if any, not including the target. For example, if the LNK file points to `cmd.exe /v /c python.exe`, this method will return `/v /c python.exe`.

- `QString description() const`

  Returns the description of the LNK file. The description is the custom text that appears when hovering over the LNK file in Windows Explorer, and can be edited in Windows Explorer by going to Properties -> Comment. If the LNK file has no custom description, this method returns an empty string.

- `bool exists() const`

  Returns `true` if the LNK file exists, regardless of whether or not it is a valid LNK file, and returns `false` otherwise. See also `isValid()` and `targetExists()`.

- `bool hasCustomIcon() const`

  Returns `true` if the LNK file has a custom icon (including if the icon was manually set to be the same as its target), and `false` if it doesn't (meaning the icon shown in Windows Explorer is the same as the target's icon). See also `iconPath()` and `iconIndex()`.

- `QString iconPath() const`

  If the LNK file has a custom icon, returns the path to the file containing that icon. Returns an empty string if the LNK file has no custom icon. See also `hasCustomIcon()` and `iconIndex()`.

- `int iconIndex() const`

  If the LNK file has a custom icon, returns the index of that icon in the icon file. Returns zero if the LNK file has no custom icon. See also `hasCustomIcon()` and `iconPath()`.

- `bool isValid() const`

  Returns `true` if the LNK file exists and is a valid LNK file (regardless of whether or not the target exists), and `false` otherwise. See also `exists()` and `targetExists()`.

- `void refresh()`

  Re-reads all the information about the LNK file from the file system.

- `bool targetExists() const`

  Returns `true` if the target exists, and `false` otherwise. See also `exists()` and `isValid()`.

- `QFile targetFile() const`

  Returns a [`QFile`](https://doc.qt.io/qt-5/qfile.html) object corresponding to the target.

- `QFileInfo targetFileInfo() const`

  Returns a [`QFileInfo`](https://doc.qt.io/qt-5/qfileinfo.html) object corresponding to the target.

- `bool targetHasAttribute(Attribute attribute) const`

  Returns true if the target has the attribute `attribute`, and false otherwise. Note that this method only reads the information present in the LNK file, so the information might not be up to date. For up to date information about whether the target is read-only, hidden or is a directory, you can use [`targetFileInfo().isWritable()`](https://doc.qt.io/qt-5/qfileinfo.html#isWritable), [`targetFileInfo().isHidden()`](https://doc.qt.io/qt-5/qfileinfo.html#isHidden) or [`targetFileInfo().isDir()`](https://doc.qt.io/qt-5/qfileinfo.html#isDir).

- `bool targetIsOnNetwork() const`

  Returns `true` if the target is on a network drive, and `false` otherwise.

- `unsigned int targetSize() const`

  Returns the size of the target file in bytes.  Note that this method only reads the information present in the LNK file, so the information might not be up to date. For up to date information, you can use [`targetFileInfo().size()`](https://doc.qt.io/qt-5/qfileinfo.html#size).

- `int targetVolumeSerial() const`

  Returns the serial number of the volume that the target is on. Returns zero if target is on a network drive.

- `VolumeType targetVolumeType() const`

  Returns the type of volume the target is on.

- `QString targetVolumeName() const`

  Returns the name of the drive the target is on as shown in the This PC folder if that drive has a custom name, and an empty string otherwise. Note that on most Windows computers, while the hard drive is called "Local Disk" by default, this is not a custom name so an empty string will be returnd in that case.

- `QString workingDirectory() const`

  Returns the working directory specified in the LNK file. This can be edited in Windows Explorer by going to Properties -> Start in.

## `LnkFileInfo::Attribute` enum
This enum is used together with the `targetHasAttribute` method to check if the target has a given attribute according to the LNK file, and contains the following values:

- `ReadOnly = 0x0001`
- `Hidden = 0x0002`
- `System = 0x0004`
- `VolumeLabel = 0x0008`
- `Directory = 0x0010`
- `Archive = 0x0020`
- `NtfsEfs = 0x0040`
- `Normal = 0x0080`
- `Temporary = 0x0100`
- `Sparse = 0x0200`
- `ReparsePointData = 0x0400`
- `Compressed = 0x0800`
- `Offline = 0x1000`

For more information about what each of these attributes mean, see [File attribute - Wikipedia](https://en.wikipedia.org/wiki/File_attribute).

## `LnkFileInfo::VolumeType` enum
This enum is used together with the `targetVolumeType` method to indicate which type of volume the target is on, and contains the following values:

- `Unknown = 0`
- `NoRootDirectory = 1`
- `Removable = 2`
- `HardDrive = 3`
- `NetworkDrive = 4`
- `CdRom = 5`
- `RamDrive = 6`

# Example code
Here is some example code that parses the Word.lnk shortcut on your desktop (if you have one). Note that the exact results may vary from one computer to another. Don't forget to change `myname` to your Windows user name.

```c++
#include "lnkfileinfo.hpp"
#include <QDebug>

int main(){
    LnkFileInfo wordLnk("C:/Users/myname/Desktop/Word.lnk");
    qDebug() << "Target path: " << wordLnk.absoluteTargetPath();    //C:\Program Files\Microsoft Office\root\Office16\WINWORD.EXE
    qDebug() << "Description: " << wordLnk.description();    //Create beautiful documents, easily work with others, and enjoy the read.
    qDebug() << "Icon path: " << wordLnk.iconPath();    //C:\Program Files\Microsoft Office\Root\VFS\Windows\Installer\{90160000-000F-0000-1000-0000000FF1CE}\wordicon.exe
    qDebug() << "Icon index: " << wordLnk.iconIndex();    //0, meaning the icon of the LNK file is the first icon in the the wordicon.exe file
    qDebug() << "Target size: " << wordLnk.targetSize();    //1637680, which is the size the WINWORD.EXE file in bytes at the time the LNK file was created

    return 0;
}
```
